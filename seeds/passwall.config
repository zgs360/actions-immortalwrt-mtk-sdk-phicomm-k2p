# 基础目标配置（必须）
CONFIG_TARGET_ramips=y
CONFIG_TARGET_ramips_mt7621=y
CONFIG_TARGET_ramips_mt7621_DEVICE_phicomm_k2p=y

# 最小化系统组件
CONFIG_TARGET_PREINIT_DISABLE_FAILSAFE=y
CONFIG_TARGET_PREINIT_SUPPRESS_STDERR=y

# 核心网络支持（精简版）
CONFIG_PACKAGE_ipset=y
CONFIG_PACKAGE_iptables-mod-tproxy=y  # 透明代理必需
CONFIG_PACKAGE_kmod-ipt-tproxy=y
CONFIG_PACKAGE_libipset=y
CONFIG_PACKAGE_libmnl=y

# Passwall核心组件（极致精简）
CONFIG_PACKAGE_luci-app-passwall=y
CONFIG_PACKAGE_luci-app-passwall_INCLUDE_Xray=y
CONFIG_PACKAGE_luci-app-passwall_Transparent_Proxy=y
CONFIG_PACKAGE_luci-i18n-passwall-zh-cn=y
CONFIG_PACKAGE_xray-core=y
CONFIG_XRAY_COMPRESS_GOPROXY=y
CONFIG_XRAY_EXCLUDE_ASSETS=y  # 移除geoip等资源文件（需手动上传）

# 最小依赖库
CONFIG_PACKAGE_ca-bundle=y
CONFIG_PACKAGE_libopenssl=y
CONFIG_PACKAGE_zlib=y

# 绝对必要工具
CONFIG_PACKAGE_coreutils-base64=y
CONFIG_PACKAGE_dns2socks=y
CONFIG_PACKAGE_resolveip=y

# 极限精简内核模块
CONFIG_PACKAGE_kmod-crypto-hash=y
CONFIG_PACKAGE_kmod-crypto-lib-chacha20poly1305=y
CONFIG_PACKAGE_kmod-ipt-core=y
CONFIG_PACKAGE_kmod-nf-conntrack=y
CONFIG_PACKAGE_kmod-nf-ipt=y
CONFIG_PACKAGE_kmod-nf-nat=y

# 关键编译优化
CONFIG_BINARY_DIR="/tmp"  # 使用内存编译减少写入
CONFIG_BUILD_LOG=y
CONFIG_BUILD_LOG_DIR="/tmp"
CONFIG_IB=y
CONFIG_KERNEL_PRINTK=n
CONFIG_STRIP_ARGS="--strip-unneeded -R .comment -R .note"

# 强制移除项
# CONFIG_DEVEL is not set
# CONFIG_PACKAGE_debug is not set
# CONFIG_PACKAGE_kmod-crypto-kpp is not set
# CONFIG_PACKAGE_kmod-lib-crc-ccitt is not set
# CONFIG_PACKAGE_kmod-nf-flow is not set
# CONFIG_PACKAGE_kmod-ppp is not set
# CONFIG_PACKAGE_kmod-slhc is not set
# CONFIG_PACKAGE_libpthread is not set
# CONFIG_PACKAGE_librt is not set
# CONFIG_PACKAGE_libstdcpp is not set
# CONFIG_PACKAGE_uci-locale-default is not set
# CONFIG_PACKAGE_uci-locale-en is not set
